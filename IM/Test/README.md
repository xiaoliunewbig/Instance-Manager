# IM系统测试

这个目录包含了IM系统的测试代码。

## 构建测试

确保已经先构建了主项目，然后进入Test目录构建测试程序：

```bash
cd Test
mkdir build
cd build
cmake ..
make
```

## 运行测试

在构建完成后，可以运行不同的测试程序：

### 基本服务器测试

```bash
# 确保主服务器已经启动
# 默认连接到 localhost:50051
./server_test

# 或者指定服务器地址
./server_test 192.168.1.100:50051
```

### 高级测试用例

```bash
# 运行基本功能测试
./test_cases localhost:50051 0

# 运行性能测试
./test_cases localhost:50051 1

# 运行所有测试
./test_cases localhost:50051 2
```

## 测试内容

### server_test

基本服务器测试客户端会自动执行以下测试：

1. 用户注册测试
2. 用户登录测试
3. 获取用户信息测试
4. 发送消息测试
5. 获取消息历史测试
6. 消息流测试 (双向消息通信)

### test_cases

高级测试用例分为以下几个模块：

1. 基本功能测试
   - 用户注册
   - 用户登录
   - 获取用户信息
   - 更新用户信息
   - 发送消息
   - 获取消息历史

2. 性能测试
   - 批量消息发送性能测试
   - 每条消息平均处理时间统计

## 扩展测试

如需添加新的测试用例，只需在`src/test_cases.cpp`文件中：

1. 为新功能创建一个测试类，继承自`TestCase`基类
2. 实现`Run()`和`GetName()`方法
3. 在`IMTestSuite`类中添加对应的测试方法
4. 在`main`函数中添加运行选项

## 注意事项

- 测试前请确保服务器已正确配置并启动
- 测试过程会创建测试用户
- 如果注册失败，测试会尝试用已有账号登录
- 测试中的消息会发送给ID为1的用户（通常是管理员） 